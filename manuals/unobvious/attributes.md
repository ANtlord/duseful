# Атрибуты

В языке D достаточно много атрибутов:

`static` -- создание статических полей, методов

`extern` -- linkage атрибут

`abstract` -- абстрактные методы и классы

`final` -- такие методы класса нельзя переопределить

`override` -- переопределение методов в дочерних классах должно помечаться этим атрибутом

`synchronized` -- "синтаксический сахар" для многопоточности (используется встроенный mutex класса при доступе к методу)

`scope` -- обещание не сохранять нигде и не передавать никуда параметр функции или метода

`const` -- не позволяет изменять внутри метода поля класса/структуры

`immutable` -- вызывается для неизменяемых объектов

`inout` -- методы, помеченные этим атрибутом могут использоваться как для изменяемого, так и для неизменяемого кода

`shared` -- можно использовать в многопоточном коде

`__gshared` -- настоящие "глобальные" переменные

`nothrow` -- компилятор гарантирует, что функция или метод не выбрасывают исключение

`pure` -- компилятор гарантирует, что функция или метод не обращаются к изменяемым глобальным данным

`ref` -- атрибут параметров и возвращаемого значения методов и функций

`return` -- атрибут параметров методов и функций

`@property` -- метод класса/структуры можно использовать как поле (`foo.a = 10; auto x = foo.a * 2`)
`@safe` -- memory-safe код
`@trusted` -- системный код, который можно вызывать из `@safe`
`@system` -- системный код (по умолчанию для всего кода)
`@nogc` -- внутри метода или функции запрещены обращения к сборщику мусора (выделение памяти через GC)
`@disable` -- можно отключить некоторые функции (конструктор по умолчанию у структур)

Какие-то из них используются с символом `@`, какие-то без. Какие-то можно объединить в логические группы,
какие-то нет. На начальных этапах можно обойтись вовсе без них, но с ростом уровня знания языка в атрибутах
появится необходимость, к тому же некоторые библиотеки используют их таким образом, что в своём коде придётся
с этим считаться.

## Безопасный и системный код

`@safe`, `@trusted`, `@system` -- реализуют 2 уровня безопасности кода (memory-safe и system) и промежуточный
слой между ними. Код без этих атрибутов по умолчанию `@system`. В коде, помеченном как `@safe` многие
операции с указателями запрещены. Зачастую требуется из `@safe` кода вызвать `@system` код. Для этого
используется `@trusted`. Но атрибутом можно пометить только функцию или метод, а иногда нужно пару операций,
для которых создавать отдельную функцию не удобно. Решается это таким образом:

```d
void foo(int a, int b) @safe
{
...
    () @trusted {
    ... блок системного кода ...
    } ();
...
}
```
Здесь мы внутри `foo`, помеченном как `@safe`, создаём `@trusted` делегат, который сразу же вызываем.

Использовать эту группу атрибутов имеет смысл, когда нужно гарантировать некоторый уровень безопасности, следовательно
применять `@trusted` нужно с [осторожностью (en)](https://dlang.org/blog/2016/09/28/how-to-write-trusted-code-in-d/).
